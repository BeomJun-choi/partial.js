<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>pure functions - pipe</title>
</head>
<body>

<script src="../partial.js"></script>

<script>
  var log = console.log;

//  var f = _.pipe(
//    function() {},
//    function() {},
//    function() {});
//
//  var f = _.pipe.async(
//    function() {},
//    function() {},
//    function() {});
//
//  var f = _.indent(
//    function() {},
//    function() {},
//    function() {});
//
//  var f = _.indent.async(
//    function() {},
//    function() {},
//    function() {});
//
//  _.go(_.mr(1, 2, 3),
//    function() {},
//    function() {},
//    function() {});
//
//  _.go.async(_.mr(1, 2, 3),
//    function() {},
//    function() {},
//    function() {});
//
//  __ == _.pipe;
//
//  var f = __(
//    function() {},
//    function() {},
//    function() {});
//
//  var f = __.async(
//    function() {},
//    function() {},
//    function() {});
//
//  _.callback(function(a,b,c, cb) {
//    cb(aa);
//  })(1,2,3).then(func);
//
//  ___ == _.indent;
//
//  var f = ___(
//    function() {},
//    function() {},
//    function() {});
//
//  var f = ___.async(
//    function() {},
//    function() {},
//    function() {});
//
//  _ = partial;
//  __ = pipe;
//  ___ = indent;
//
//  _(_, _, ___, 5);
//
//  __(
//    __,
//    function() {});
//
//  __ = _.pipe();
//
//  __.map = function(func) {
//    return _(_.map, _, func);
//  };
//
//  __.map(function() {
//
//  });
//
//  _(_.map, _, function() {
//
//  });
//
//  _(_.map, _, function() {
//
//  });
//
//  _.map(function() {
//
//  });
//
//  __(
//    _.map(function() {
//
//    }),
//    _.map(__(
//      function() {},
//      function() {},
//      function() {},
//      function() {})),
//    _.map(__.async(
//      function() {},
//      function() {},
//      function() {},
//      function() {})));
//
//  _.go.async
//
//  _.map([1,2,3], _);
//

  /*log(_.Pipe(
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  )(10));

  log('-----------------------------')

  log(_.Indent(
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  )(undefined));

  log('-----------------------------')

  log(_.pipe(10,
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  ));

  log('-----------------------------')

  log(_.pipec({hi:'hi'}, 10,
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  ));

  log('-----------------------------')

  log(_.pipea({hi:'hi'}, 10, [
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  ]));*/

 /* log(_.async.Pipe(
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  )(10));

  log('-----------------------------')

  log(_.async.Indent(
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  )(undefined));

  log('-----------------------------')

  log(_.async.pipe(10,
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    _.callback(function(a, next) {
      setTimeout(function() {
        next(10 + a, 20);
      }, 500);
    }),
    function(a) {
      log(arguments);
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  ));

  log('-----------------------------')

  log(_.async.pipec({hi:'hi'}, 10,
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  ));

  log('-----------------------------')

  log(_.async.pipea({hi:'hi'}, 10, [
    log,
    _.noop,
    log,
    function() {
      return 1;
    },
    function(a) {
      log(this);
    },
    function() {
      return _.mr(20, 5);
    },
    log,
    function(a, b) {
      return [1,2,3];
    },
    _.to_mr,
    function(a, b, c) {
      console.log(a, b, c);
    }
  ]));*/


//  _.callback(function(next) {
//    setTimeout(function() {
//      next(10)
//    })
//  })().then(function(a) {
//    console.log(a);
//  });

//  var add1 = function(v) { return v + 1; };
//
//  _.go(1,
//    add1,
//    function(a) {
//      return new Promise(function(rs) {
//        rs(a + 1);
//      })
//    },
//    add1,
//    add1,
//    _.log);

  /*var args = [0];
  for (var i = 0; i < 10000; i++) {
    args.push(_.identity);
  }
  console.time();
  _.go2.apply(null, args);
  console.timeEnd();*/

  console.log = log;

  _.go(
    _.mr([1, 2, 3], 20),
    _.each(log));

  _.each([1, 2, 3], log, 20);

  _.each([1,2,3], function(v) {
    return new Promise(function(rs) {
      setTimeout(function() {
        console.log(v);
        rs();
      }, 1000)
    });
  }).then(function(data) {
    console.log('end', data);
  });

  _.each({
    a: 1,
    b: 2,
    c: 3
  }, function(v) {
    return new Promise(function(rs) {
      setTimeout(function() {
        console.log(v);
        rs();
      }, 1000)
    });
  }).then(function(data) {
    console.log('end', data);
  });


  _.log('map', _.go(
    _.mr([1, 2, 3], 20),
    _.map(v => v * 3)));

  _.log('map2', _.map([1, 2, 3], v => v * 4, 20));

  _.map([1,2,3], function(v) {
    return new Promise(function(rs) {
      setTimeout(function() {
        console.log(v);
        rs(v * 2);
      }, 1000)
    });
  }).then(function(data) {
    console.log('map', data);
  });

  _.map({
    a: 1,
    b: 2,
    c: 3
  }, function(v) {
    return new Promise(function(rs) {
      setTimeout(function() {
        console.log(v);
        rs(v*2);
      }, 1000)
    });
  }).then(function(data) {
    console.log('map', data);
  });


  _.log('reduce', _.go(
    _.mr([1, 2, 3], 20),
    _.map(v => v * 3)));

  _.log('map2', _.map([1, 2, 3], v => v * 4, 20));

  _.map([1,2,3], function(v) {
    return new Promise(function(rs) {
      setTimeout(function() {
        console.log(v);
        rs(v * 2);
      }, 1000)
    });
  }).then(function(data) {
    console.log('map', data);
  });

  _.map({
    a: 1,
    b: 2,
    c: 3
  }, function(v) {
    return new Promise(function(rs) {
      setTimeout(function() {
        console.log(v);
        rs(v*2);
      }, 1000)
    });
  }).then(function(data) {
    console.log('map', data);
  });


</script>


</body>
</html>